package phase1;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;

public class WelcomeApPpage {
	
	static Scanner keyboard=new Scanner(System.in);
	public static Scanner Userinput;
 	public static Scanner Crendentialinput;
 	public static PrintWriter Useroutput;
	public static PrintWriter Crendentialoutput;
	public static  Users users;
	public static Usercredentials usercredentials;
	
public static void main(String[] args) throws IOException {
//		Scanner sc=new Scanner(System.in);
//		
//		System.out.println("enter the file name");
//		String file=sc.next();
//		

		
		InitiliazeFiles();
		Welcomelockme();
		Signinoptions();	
	}
public  static void Welcomelockme() {
	System.out.println("----------------------");
	System.out.println("***********************");
	System.out.println("                       ");
	System.out.println("WELCOME TO THE LOCKMEAPP.COM");
	System.out.println("YOUR DIGITIAL LOCKER.....GENERATED BY COMPANY LOCKERS PRIVATE LIMITED....."
			+ "DEVELOPED BY:SWETHA...");
	System.out.println("                       ");
	System.out.println("***********************");
	System.out.println("----------------------");
	}
public static void Signinoptions() throws IOException  {
	System.out.println("1.Register" );
	System.out.println("2.Login" );
	int option=keyboard.nextInt();
	switch(option) {
	case 1:
		Registration();
		break;
	case 2:
		Login();
		break;
    default:
	System.out.println("Please Select 1 or 2 ");
	break;
	
	}
		
	}
public static void Createfile(String file) throws IOException {
	try {
		File newfile=new File(file);
		if(newfile.createNewFile()) {
			System.out.println("file created successfully!!!");
		}
		if(newfile.exists()) {
			System.out.println("FIle Already exsists duplicate cannot be created");
		}
		
	} catch (Exception e) {
	e.printStackTrace();
	}
}
public static void Registration() throws IOException {
	
		System.out.println("----------------------");
		System.out.println("***********************");
		System.out.println("                       ");
		System.out.println("WELCOME TO THE REGISTRATION");
		System.out.println("                       ");
		System.out.println("***********************");
		System.out.println("----------------------");
		System.out.println("Enter Username");
	    String username=keyboard.next();
	    users= new Users();
	    users.setUsername(username);
	    while(Userinput.hasNext()) {
	    	if(Userinput.next().contains(username)) {
	    		System.out.println("User name already exsists cannot be Registered---");
	    		return;
	    	}
	    	else {
	    		users.setUsername(username);
	    		
	    	}
    }
	   
	    System.out.println("Enter Password");
		String password=keyboard.next();
	    users.setPassword(password);
	    Useroutput.println(users.username);
	    Useroutput.println(users.password);
	    Useroutput.close();  
		System.out.println("Registration Successful!!!.......");
	}
public static void Login() throws IOException {
 	System.out.println("----------------------");
 	System.out.println("***********************");
	System.out.println("                       ");
	System.out.println("WELCOME TO THE LOGIN");
	System.out.println("                       ");
	System.out.println("***********************");
	System.out.println("----------------------");
	System.out.println("Enter the Username");
	String input=keyboard.next();
	boolean isfound=false;
	while (Userinput.hasNext()&&!isfound) {
		
		if(Userinput.next().equals(input)) {
	
			System.out.println("enter the password");
			String inputpassword=keyboard.next();
			if(Userinput.next().equals(inputpassword)) {
				System.out.println("LOGIN SUCCESSFULL!!");
				isfound=true;
				lockeroptions(input);
				break;
			}
			
			if(!isfound) {
				isfound=true;
				System.out.println("Please check the password and enter the password correctly!! ");
				break;
			}
		}
	}
	if(!isfound) {
		System.out.println("User Not Found!!! 404");
	}	}
public static void lockeroptions(String input) throws IOException {
	System.out.println("1 FETCH ALL STORED CREDENTIALS");
	System.out.println("2 STORE THE CREDENTIALS");
	System.out.println("3 CREATE NEW FILE");
	System.out.println("4 DELETE ALL THE CREDENTIALS");
	int option=keyboard.nextInt();
	switch(option) {
	case 1:
		Fetchcredentials(input);
		break;
	case 2:
		Storecredentilas(input);
		break;
	 case 3:
		 Createfile1(input);
		break;
	 case 4:
			DeleteCredentials();
			break;
	}
  
}	
private static void DeleteCredentials() throws IOException {
	Scanner scaninput=new Scanner(System.in);
	String Name;
	String record;
	File Readfileaddress=new File("src/phase1/credentials.txt");
	List<String> lines= new ArrayList<String>();
	BufferedReader br=new BufferedReader(new FileReader(Readfileaddress));
	System.out.println("enter the username to delete");
	Name=scaninput.nextLine();
	int i=0;
	int n=0;
	String line= null;
	while ((line=br.readLine())!=null) {
		i++;
		if(i==4*n+1) {
			n++;
			if(line.contains(Name)) {
				line= line.replace(Name, "");
			}
			lines.add(line);
		}
	}
	br.close();
	FileWriter fw = new FileWriter(Readfileaddress);
	BufferedWriter bw= new BufferedWriter(fw);
	for(String s:lines) {
		bw.write(s);
	}
	bw.flush();
	bw.close();
}



private static void SearchCredentials() {

	Scanner sc=new Scanner(System.in);
	System.out.println("enter  the Sitename for searching");
String sitedetails=sc.next();
String line="";
try {
	FileInputStream fin=new FileInputStream("src/phase1/credentials.txt");
	Scanner s=new Scanner(fin);
	while(s.hasNext()) {
		line=sc.nextLine();
		if(line.equals(sitedetails)) {
			System.out.println(sitedetails);
		}		}
	s.close();
	sc.close();
} 
catch (Exception e) {
	// TODO: handle exception
	e.printStackTrace();
}
}
public static void Fetchcredentials(String input) {
	System.out.println("---------------------");
	System.out.println("*                    *");
	System.out.println(                        );
	System.out.println("WELCOME TO DIGITAL LOCKER");
	System.out.println("YOU CREDENTIALS ARE...");
	System.out.println("*                    *");
	System.out.println("---------------------");
	System.out.println(input);
	while(Crendentialinput.hasNext()) {
		if(Crendentialinput.next().equals(input)) {
			System.out.println("SITE NAME:"+Crendentialinput.next());
			System.out.println("USER NAME:"+Crendentialinput.next());
			System.out.println("USER PASSWORD:"+Crendentialinput.next());
		}
	}
	
	
}
public static void Storecredentilas(String loginuser) {
	
	System.out.println("----------------------");
 	System.out.println("***********************");
	System.out.println("                       ");
	System.out.println("WELCOME TO THE  DIGITALLOCKER TO STORE CREDENTIALS");
	System.out.println("                       ");
	System.out.println("***********************");
	System.out.println("----------------------");
	usercredentials.setLoginuser(loginuser);
	System.out.println("Enter the site name");
	String sitename=keyboard.next();
	usercredentials.setSitename(sitename);
	System.out.println("Enter the user name");
	String username=keyboard.next();
	usercredentials.setUsername(username);
	System.out.println("Enter the password");
	String password=keyboard.next();
	usercredentials.setPassword(password);
	Crendentialoutput.println(usercredentials.getLoginuser());
	Crendentialoutput.println(usercredentials.getSitename());
	Crendentialoutput.println(usercredentials.getUsername());
	Crendentialoutput.println(usercredentials.getPassword());
	System.out.println( "YOUR CREDETIALS ARE STORED SUCCESSFULLY");
	Crendentialoutput.close();	
}
public static void InitiliazeFiles() throws IOException {
	File Userdatafile=new File("/home/swethar839gmail/Project/Phase1project/usersData.txt");
	File Credential=new File("/home/swethar839gmail/Project/Phase1project/credentials.txt");
	try {
		Userinput=new Scanner(Userdatafile);
		
	Crendentialinput=new Scanner(Credential);
	keyboard=new Scanner(System.in);
	Useroutput= new PrintWriter(new FileWriter(Userdatafile,true));
	
	Crendentialoutput=new PrintWriter(new FileWriter(Credential,true));
	
	users=new Users();
    usercredentials=new Usercredentials();
		
	} catch (Exception e) {
		System.out.println("404 File Not Found");
	}
		
	
	
}
public static void Createfile1(String file) throws IOException {

	try {
		Scanner sc=new Scanner(System.in);
		System.out.println("enter the file name to create new file");
		String file1=sc.next();
		String generatefile=file1+".txt";
		File newfile=new File(generatefile);
		if(newfile.createNewFile()) {
			System.out.println("file created successfully!!!");
		}
		if(newfile.exists()) {
			System.out.println("file Already exsits duplicate  not allowed!!!!!");
		}
		sc.close();
	} catch (Exception e) {
	e.printStackTrace();;
	}
	
}
	}



